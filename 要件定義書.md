# 映画紹介アプリ 要件定義書

**プロジェクト名**: Kadai Movie App  
**作成日**: 2025年10月15日  
**バージョン**: 1.0  
**ステータス**: 初期開発フェーズ

---

## 目次

1. [目的](#目的)
2. [ターゲットユーザー](#ターゲットユーザー)
3. [機能要件](#機能要件)
4. [非機能要件](#非機能要件)
5. [ユーザーフロー](#ユーザーフロー)
6. [画面仕様](#画面仕様)
7. [技術スタック](#技術スタック)
8. [開発ロードマップ](#開発ロードマップ)

---

## 目的

### アプリの目的

このアプリは、**TMDB APIを活用して最新の映画情報を紹介し、ユーザーが興味のある映画を簡単に見つけられるWebアプリケーション**です。

#### 解決する課題

- 「今日何を観ようか」と迷う時間を削減
- 人気作品や評価の高い映画を一目で確認したい
- 映画の詳細情報を手軽にチェックしたい
- 観たい映画を忘れないように管理したい

#### 提供する価値

1. **情報の一元化**: TMDB APIから最新の映画情報を取得し、分かりやすく表示
2. **直感的なUI**: カード形式で視覚的に映画を選べる
3. **効率的な検索**: カテゴリー別・ジャンル別で目的の映画を素早く発見
4. **パーソナライゼーション**: お気に入り機能で自分だけの映画リストを作成

#### 成功指標（KPI）

- 月間アクティブユーザー数（MAU）: 1,000人以上（3ヶ月後）
- 平均セッション時間: 5分以上
- 映画詳細ページ閲覧率: 60%以上
- お気に入り機能利用率: 30%以上

---

## ターゲットユーザー

### ユーザーペルソナ（3パターン）

#### パターン1: 週末映画派 - カジュアル映画ファン層 【メインターゲット】

**ペルソナ**: 田中 さくら（28歳、会社員）

**特徴**:
- 週末や平日の夜に映画を観てリラックスしたい
- Netflixなどのストリーミングサービスを日常的に利用
- 「何を観ようか」迷う時間を減らしたい
- トレンドの映画や人気作品をサクッとチェックしたい
- スマートフォンでの利用が中心

**ニーズ**:
- 今人気の映画を一目で確認
- 評価や公開日で選びたい
- スマホでサクサク閲覧
- 観たい映画リストを保存

**利用シーン**:
- 金曜日の夜、週末に観る映画を探す
- 通勤中に話題の映画をチェック
- 友人との会話で出た映画をその場で検索

---

#### パターン2: 映画マニア - コアな映画愛好家層

**ペルソナ**: 佐藤 健太（35歳、デザイナー）

**特徴**:
- 映画は趣味を超えてライフスタイル
- 公開初日に映画館で鑑賞することも多い
- IMDbやFilmarksで評価をチェックする習慣がある
- ジャンルや監督、俳優で映画を選ぶ
- 新作情報に敏感

**ニーズ**:
- 詳細な映画情報（キャスト、監督、ジャンル）
- 公開予定作品の先行情報
- マイナー作品も含めた幅広い検索機能
- レビューや評価の詳細データ
- お気に入り登録・コレクション管理

**利用シーン**:
- 毎日のように新作情報をチェック
- 好きな監督の作品を一覧で確認
- マイコレクションを整理・管理

---

#### パターン3: デート・家族イベント層

**ペルソナ**: 山田 優子（32歳、主婦・パート勤務）

**特徴**:
- 友人や家族との外出時に映画を選択肢に入れる
- 「みんなで楽しめる」作品を重視
- 子供と一緒に観られる映画を探している
- SNSで話題の映画をチェック
- 映画館の雰囲気も含めて楽しみたい

**ニーズ**:
- 家族向け・子供向けフィルター機能
- SNSシェア機能（「これ観たい！」を共有）
- 上映中の映画と公開予定の区別
- あらすじで内容を事前確認
- 視聴済み映画の記録・共有

**利用シーン**:
- 週末の家族でのお出かけプランを立てる時
- 友人とのグループLINEで映画を提案
- 子供が観られる映画を探す

---

## 機能要件

### フェーズ1: MVP（最小限の製品）

#### ✅ 実装済み機能

- **映画一覧表示**
  - 人気映画をカード形式で表示
  - ポスター画像、タイトル、評価、公開日を表示
  - レスポンシブデザイン対応

#### 🔧 優先実装機能

##### 1. 映画詳細ページ
- **URL**: `/movies/[id]`
- **表示内容**:
  - ポスター画像（大）
  - タイトル・原題
  - 公開日・上映時間
  - ジャンルタグ
  - あらすじ・概要
  - 評価（星表示 + 数値）
  - キャスト情報（写真・名前・役名）
  - 監督・制作スタッフ情報
  - 予告編動画（YouTube埋め込み）
  - 関連映画（おすすめ）
- **機能**:
  - お気に入りボタン
  - シェアボタン
  - 前の画面に戻るボタン

##### 2. カテゴリー別表示
- **人気映画** (`/movies/popular`) ✅実装済み
- **現在上映中** (`/movies/now-playing`)
- **公開予定** (`/movies/upcoming`)
- **高評価映画** (`/movies/top-rated`)
- **トレンド** (`/movies/trending`)

##### 3. 検索機能
- **URL**: `/search`
- **機能**:
  - キーワード検索（タイトル）
  - リアルタイム検索結果表示
  - 検索履歴（ローカルストレージ）
  - 検索結果のカード表示
  - 「結果が見つかりません」表示

##### 4. ナビゲーション
- **ヘッダー**:
  - ロゴ（ホームリンク）
  - 検索バー
  - カテゴリーメニュー
  - お気に入りアイコン
- **フッター**:
  - TMDB ロゴ・クレジット
  - プライバシーポリシーリンク
  - 利用規約リンク
  - お問い合わせリンク

##### 5. ページネーション
- 20件ごとに表示
- ページ番号表示（1, 2, 3...）
- 前へ・次へボタン
- ページ上部へスクロール

---

### フェーズ2: ユーザーエンゲージメント向上

##### 6. お気に入り機能
- **URL**: `/favorites`
- **機能**:
  - 映画カードの「お気に入り」ボタン
  - ローカルストレージに保存
  - お気に入り一覧ページ
  - お気に入り解除機能
  - お気に入り件数表示

##### 7. フィルター・ソート機能
- **ジャンル別絞り込み**:
  - ドロップダウンまたはタグ選択
  - 複数ジャンル選択可能
- **ソート機能**:
  - 評価順（高い順・低い順）
  - 公開日順（新しい順・古い順）
  - タイトル順（ABC順）
- **その他フィルター**:
  - 公開年範囲指定
  - 評価範囲指定

##### 8. 視聴履歴管理
- **「観た」ボタン**
- **視聴済み一覧** (`/watched`)
- **マイ評価機能**（5段階評価）
- **視聴日記録**

##### 9. シェア機能
- Twitter/Xシェアボタン
- URLコピーボタン
- OGP設定（リンクプレビュー最適化）

##### 10. ダークモード
- ライト/ダーク切り替えトグル
- ユーザー設定の保存
- システム設定の自動検知

---

### フェーズ3: コミュニティ・高度な機能

##### 11. ユーザー認証
- メールアドレス登録
- Google/GitHubログイン
- プロフィール管理
- アカウント削除機能

##### 12. レビュー・コメント機能
- レビュー投稿
- 星評価
- いいね機能
- コメント返信
- スパム報告機能

##### 13. レコメンド機能
- AIベースのおすすめ
- 「この映画を観た人はこれも」
- パーソナライズド表示
- 視聴履歴ベースの提案

##### 14. コレクション機能
- カスタムリスト作成
- 「観たい映画リスト」
- 「2024年ベスト10」など
- リスト公開・シェア

---

### フェーズ4: 付加価値機能（将来構想）

##### 15. 動画配信サービス連携
- Netflix/Prime Video対応状況表示
- 「今すぐ観られる」フィルター
- 配信サービスへのリンク

##### 16. 映画館情報
- 近くの映画館検索
- 上映時間表示
- チケット予約サイトリンク

##### 17. 通知機能
- 公開日リマインダー
- 新作情報プッシュ通知
- お気に入り俳優の新作アラート

##### 18. 統計・分析
- 自分の視聴統計
- 年間視聴映画数
- よく観るジャンル分析
- 視聴時間グラフ

---

## 非機能要件

### 1. パフォーマンス

#### 応答性能
- **初回ページロード**: 3秒以内
- **画面遷移**: 1秒以内
- **API応答時間**: 2秒以内

#### Core Web Vitals
- **LCP (Largest Contentful Paint)**: 2.5秒以内
- **FID (First Input Delay)**: 100ms以内
- **CLS (Cumulative Layout Shift)**: 0.1以下

#### 画像最適化
- Next.js Image最適化を使用
- WebP/AVIF形式での配信
- 遅延読み込み（Lazy Loading）実装
- レスポンシブ画像（適切なサイズ）

#### キャッシング戦略
- TMDB APIレスポンスのキャッシュ（1時間）
- 静的アセットのブラウザキャッシュ
- CDN活用（画像配信）
- ISR（Incremental Static Regeneration）活用

---

### 2. スケーラビリティ

#### 同時接続数
- 初期: 100ユーザー/秒
- 成長期: 1,000ユーザー/秒
- ピーク時対応（週末・新作公開日）

#### データ量
- 映画データ: 数万件まで対応
- ユーザーデータ: 10万ユーザーまで
- レビューデータ: 100万件まで

#### API制限対応
- TMDB API: 40リクエスト/10秒制限
- レートリミット実装
- リクエスト最適化（バッチ処理）
- フォールバック機能

---

### 3. 可用性

#### アップタイム
- **目標稼働率**: 99.9%（月間ダウンタイム43分以内）
- **メンテナンス時間**: 月1回、深夜2時間以内
- **計画的ダウンタイムの事前通知**

#### エラーハンドリング
- API障害時のフォールバック表示
- ユーザーフレンドリーなエラーメッセージ
- 404/500エラーページのカスタマイズ
- エラーログの自動収集

#### 監視・アラート
- サーバー死活監視（UptimeRobot等）
- エラー率監視（Sentry等）
- APIレスポンス時間監視
- 異常検知時の自動通知

---

### 4. セキュリティ

#### API保護
- ✅ APIキーの環境変数化（`.env.local`）
- ✅ サーバーサイドでのAPI呼び出し
- ✅ クライアントにAPIキー非露出
- CORS設定

#### データ保護
- HTTPS通信の強制
- ユーザーデータの暗号化（将来）
- パスワードのハッシュ化（将来）
- 個人情報の適切な管理

#### 認証・認可（将来実装時）
- JWT/セッション管理
- OAuth 2.0対応（Google/GitHub）
- CSRF対策
- XSS/SQLインジェクション対策

#### 脆弱性対策
- 依存パッケージの定期アップデート
- `npm audit` の定期実行
- セキュリティヘッダー設定
- Content Security Policy (CSP)

#### プライバシー
- Cookie同意バナー
- プライバシーポリシー掲載
- データ削除リクエスト対応
- GDPR準拠（EU対応時）

---

### 5. ユーザビリティ

#### レスポンシブデザイン
- ✅ モバイル（320px〜）
- ✅ タブレット（768px〜）
- ✅ デスクトップ（1024px〜）
- ✅ 大画面（1440px〜）

#### アクセシビリティ（WCAG 2.1 レベルAA準拠）
- キーボード操作対応
- スクリーンリーダー対応（ARIA属性）
- 適切なコントラスト比（4.5:1以上）
- フォーカス表示の明確化
- alt属性の適切な設定

#### ブラウザ対応
- Chrome（最新2バージョン）
- Firefox（最新2バージョン）
- Safari（最新2バージョン）
- Edge（最新2バージョン）
- iOS Safari / Android Chrome

#### UX
- ローディング表示（スケルトンスクリーン）
- スムーズなアニメーション
- 直感的なナビゲーション
- エラー時の適切なフィードバック

---

### 6. 保守性

#### コード品質
- ESLint設定・実行
- Prettier（コードフォーマット）
- TypeScript化（推奨）
- コードレビュープロセス

#### テスト
- 単体テスト（Jest）カバレッジ80%以上
- E2Eテスト（Playwright/Cypress）主要フロー
- ビジュアルリグレッションテスト
- CI/CDでの自動テスト実行

#### ドキュメント
- README.md（セットアップ手順）
- API仕様書
- コンポーネントカタログ（Storybook）
- 環境変数ドキュメント

#### バージョン管理
- Git使用
- ブランチ戦略（Git Flow）
- コミットメッセージ規約
- セマンティックバージョニング

---

### 7. 運用性

#### デプロイ
- CI/CD パイプライン（GitHub Actions）
- 自動デプロイ（Vercel）
- ステージング環境
- ロールバック機能

#### ログ・モニタリング
- アクセスログ収集
- エラーログ監視（Sentry）
- パフォーマンス監視（Vercel Analytics）
- ユーザー行動分析（Google Analytics）

#### バックアップ
- データベースバックアップ（日次）
- ユーザーデータのバックアップ
- 障害復旧手順の文書化

---

### 8. 法令遵守

#### 利用規約
- サービス利用規約の明示
- 禁止事項の定義
- 免責事項

#### プライバシー
- プライバシーポリシー
- Cookie使用の同意取得
- 個人情報保護法遵守

#### 著作権
- TMDB APIの利用規約遵守
- TMDB ロゴ表示義務
- 画像の適切な使用
- ユーザー投稿コンテンツのライセンス

---

### 9. コスト

#### インフラコスト
- 初期: 無料枠内（Vercel/TMDB）
- 成長期: 月額〜$50
- スケール時: 従量課金モデル

#### API利用コスト
- TMDB API: 無料（制限内）
- 他サービス連携時の費用試算

---

## ユーザーフロー

### フロー1: 映画を一覧から探す場合

```
1. トップページにアクセス
   ↓
2. 「人気映画を見る」をクリック
   ↓
3. 映画一覧ページが表示される
   ↓
4. 映画を選んでクリック
   ↓
5. 映画詳細ページが開く
   ↓
6. 「戻る」で一覧ページへ戻る
```

### フロー2: 映画を検索して探す場合

```
1. トップページの検索フォームにキーワードを入力
   ↓
2. 検索結果ページが表示される
   ↓
3. 映画を選んで詳細ページへ遷移
   ↓
4. 「戻る」で検索結果一覧へ戻る
```

### フロー3: 任意のページから検索する場合

```
1. 任意のページ（一覧/詳細/検索結果）にいる
   ↓
2. ヘッダーの検索バーにキーワードを入力
   ↓
3. 検索結果ページが表示される
   ↓
4. 映画を選んで詳細ページへ遷移
   ↓
5. 「戻る」で検索結果へ戻る
   ↓
6. さらに「戻る」で元のページへ戻る
```

### フロー4: カテゴリーメニューから直接アクセス

```
1. 任意のページでヘッダーのカテゴリーメニューを開く
   ↓
2. 「現在上映中」「公開予定」「高評価」などを選択
   ↓
3. 該当カテゴリーの映画一覧ページが表示される
   ↓
4. 映画を選んで詳細ページへ遷移
   ↓
5. 「戻る」で一覧ページへ戻る
```

### フロー5: 関連映画から別の映画へ遷移

```
1. 映画詳細ページを閲覧中
   ↓
2. 「関連映画」セクションの映画をクリック
   ↓
3. 別の映画詳細ページが開く
   ↓
4. 「戻る」で前の映画詳細ページへ戻る
   ↓
5. さらに関連映画を閲覧可能（詳細ページ間の移動）
```

### フロー6: エラーからの復帰

#### 6-1: 404エラーの場合
```
1. 存在しないURLにアクセス
   ↓
2. 404エラーページが表示される
   ↓
3. 「トップページへ戻る」または「映画を探す」をクリック
   ↓
4. トップページまたは映画一覧ページへ遷移
```

#### 6-2: API通信エラーの場合
```
1. 映画一覧/詳細ページでAPIエラー発生
   ↓
2. エラーメッセージとリトライボタンが表示される
   ↓
3. 「再読み込み」をクリック
   ↓
4. APIを再リクエスト → 成功すればページ表示
```

### フロー7: 直接URL入力でアクセス

```
1. ブラウザのアドレスバーに `/movies/123` を直接入力
   ↓
2. 映画詳細ページが開く（ブラウザ履歴なし）
   ↓
3. 「戻る」ボタンをクリック
   ↓
4. 映画一覧ページ (/movies) へリダイレクト（推奨）
```

**推奨**: 履歴がない場合は `/movies` (人気映画一覧) へリダイレクトし、ユーザーが他の映画も探せるようにする

---

### 画面遷移図

```
                    ┌─────────────┐
              ┌─────│トップページ │────┐
              │     │   (/)       │    │
              │     └──────┬──────┘    │
              │            │           │
[ヘッダーロゴ] │            │           │ [カテゴリーメニュー]
              │            │           │
              │     ┌──────┴──────┐    │
              │     │             │    │
              │  [人気]      [検索]     │
              │     │             │    │
              │     ↓             ↓    ↓
              │  ┌──────┐    ┌──────┐
              └─→│一覧  │    │検索  │←─┐
                 │ページ│    │結果  │  │
                 └───┬──┘    └───┬──┘  │
                     │           │     │
            ┌────────┴───────────┘  [ヘッダー]
            │                        [検索バー]
     [カードクリック]                  │
            │                          │
            ↓                          │
    ┌───────────────┐                 │
    │  映画詳細     │←────────────────┘
    │  ページ       │
    └───┬───┬───────┘
        │   │
        │   └─[関連映画クリック]
        │            ↓
    [戻る]        (詳細ページ間移動)
        │
        ↓
   (前のページ)
   履歴なし → /movies


[エラー処理]
  ┌─────────────┐
  │ 404 / 500   │
  │ エラー      │
  └──────┬──────┘
         │
    [リカバリー]
         │
         ↓
   (トップ/一覧)
```

---

### 主要な画面遷移パターン（全17パターン）

| # | 開始画面 | アクション | 遷移先画面 | 実装フェーズ |
|---|---------|-----------|-----------|-------------|
| 1 | トップページ | 「人気映画を見る」クリック | 映画一覧ページ | フェーズ1 |
| 2 | トップページ | 検索フォーム送信 | 検索結果ページ | フェーズ1 |
| 3 | 映画一覧ページ | 映画カードクリック | 映画詳細ページ | フェーズ1 |
| 4 | 検索結果ページ | 映画カードクリック | 映画詳細ページ | フェーズ1 |
| 5 | 映画詳細ページ | 「戻る」ボタン | 前のページ（履歴あり） | フェーズ1 |
| 6 | 映画詳細ページ | 「戻る」ボタン | 映画一覧ページ（履歴なし） | フェーズ1 |
| 7 | 映画詳細ページ | 関連映画クリック | 別の映画詳細ページ | フェーズ1 |
| 8 | すべてのページ | ヘッダーロゴクリック | トップページ | フェーズ1 |
| 9 | すべてのページ | ヘッダー検索バー送信 | 検索結果ページ | フェーズ1 |
| 10 | すべてのページ | カテゴリーメニュー選択 | 該当カテゴリー一覧 | フェーズ2 |
| 11 | 映画一覧ページ | ページネーション | 映画一覧ページ (page=N) | フェーズ1 |
| 12 | 存在しないURL | アクセス | 404エラーページ | フェーズ1 |
| 13 | 404ページ | 「トップへ戻る」 | トップページ | フェーズ1 |
| 14 | 404ページ | 「映画を探す」 | 映画一覧ページ | フェーズ1 |
| 15 | API障害発生 | - | エラー表示（インライン） | フェーズ1 |
| 16 | エラー表示中 | 「再読み込み」 | 同じページ（リトライ） | フェーズ1 |
| 17 | 直接URL入力 | 詳細ページアクセス | 映画詳細ページ | フェーズ1 |

---

### ナビゲーション設計

#### ヘッダーナビゲーション（全ページ共通）

**必須要素（フェーズ1）**:
- **ロゴ**: クリックでトップページ (`/`) へ遷移
- **検索バー**: どのページからでも検索可能、Enter または検索ボタンで `/search?q=キーワード` へ遷移

**追加要素（フェーズ2）**:
- **カテゴリーメニュー**: ドロップダウンで以下を選択可能
  - 人気映画 → `/movies/popular`
  - 現在上映中 → `/movies/now-playing`
  - 公開予定 → `/movies/upcoming`
  - 高評価 → `/movies/top-rated`

**実装例**:
```jsx
<header>
  <Link href="/">🎬 Kadai</Link>
  <SearchBar /> {/* 検索フォーム */}
  <CategoryMenu /> {/* カテゴリードロップダウン（フェーズ2） */}
</header>
```

---

#### 「戻る」ボタンの動作仕様

**基本動作**:
```javascript
'use client';
import { useRouter } from 'next/navigation';

const BackButton = () => {
  const router = useRouter();
  
  const handleBack = () => {
    // ブラウザの履歴があるかチェック
    if (window.history.length > 1) {
      router.back(); // 履歴があれば前のページへ
    } else {
      // 履歴がない場合は映画一覧ページへ（推奨）
      router.push('/movies');
    }
  };
  
  return (
    <button onClick={handleBack} className="back-button">
      ← 戻る
    </button>
  );
};
```

**動作パターン**:

| シナリオ | 戻る先 | 理由 |
|---------|--------|------|
| 一覧 → 詳細 → 戻る | 一覧ページ | ユーザーの期待通り |
| 検索 → 詳細 → 戻る | 検索結果ページ | 検索を継続できる |
| 詳細A → 詳細B → 戻る | 詳細A | 関連映画の閲覧を継続 |
| 直接URL → 詳細 → 戻る | **映画一覧** (`/movies`) | 他の映画も探せる |

**重要な設計判断**: 
- ❌ トップページへ戻す → ユーザーは最初からやり直し
- ✅ **映画一覧ページへ戻す** → ユーザーはすぐに他の映画を探せる

---

#### パンくずリストの表示ロジック

**実装推奨度**: 中（フェーズ2以降）

**シンプルな固定パンくず（推奨）**:
```jsx
// 映画詳細ページ
<nav>
  <Link href="/">トップ</Link> &gt;
  <Link href="/movies">映画一覧</Link> &gt;
  <span>{movie.title}</span>
</nav>

// 検索結果ページ
<nav>
  <Link href="/">トップ</Link> &gt;
  <span>検索結果: "{query}"</span>
</nav>
```

**複雑な動的パンくず（非推奨）**:
- 履歴に基づいて動的に生成すると複雑になる
- 直接URLアクセスや関連映画からの遷移で不正確になる可能性
- **シンプルな固定パンくずで十分**

---

#### ページネーション

**URL設計**:
```
/movies?page=1  (デフォルト)
/movies?page=2
/movies?page=3
...
```

**動作**:
- ページ番号クリック → URLのpageパラメータを更新
- ブラウザの戻る/進むで正しく動作
- 直接URL入力でも正しいページを表示

**実装例**:
```jsx
// app/movies/page.js
export default async function MoviesPage({ searchParams }) {
  const page = searchParams.page || 1;
  const movies = await fetchPopularMovies('ja-JP', page);
  
  return (
    <>
      <MovieList movies={movies} />
      <Pagination currentPage={page} totalPages={10} />
    </>
  );
}
```

---

## 画面仕様

### 画面一覧

アプリに必要な画面は以下の6つです：

1. **トップページ**（導入・紹介） - `/`
2. **映画一覧ページ** - `/movies`, `/tmdb-test`
3. **映画詳細ページ** - `/movies/[id]`
4. **検索結果ページ** - `/search`
5. **ログインページ**（必要に応じて） - `/login`
6. **エラーページ**（通信エラーや404） - `/error`, `404.js`, `500.js`

---

### 1. トップページ (`/`)

#### 目的
アプリの入り口となり、アプリの紹介と主要機能へのナビゲーションを提供

#### 表示内容
- ヒーローセクション
  - アプリタイトル「Kadai Movie App」
  - キャッチコピー「あなたにぴったりの映画を見つけよう」
  - メインCTA「人気映画を見る」ボタン
- カテゴリーカード
  - 人気映画
  - 現在上映中
  - 公開予定
  - 高評価映画
- トレンド映画（横スクロール）
- フッター

#### レイアウト
```
┌─────────────────────────────────┐
│ [Header - ロゴ / 検索 / メニュー]│
├─────────────────────────────────┤
│                                 │
│   [ヒーローセクション]          │
│   タイトル + CTA                │
│                                 │
├─────────────────────────────────┤
│                                 │
│   [カテゴリーカード x 4]        │
│   ┌──┐ ┌──┐ ┌──┐ ┌──┐        │
│   │  │ │  │ │  │ │  │        │
│   └──┘ └──┘ └──┘ └──┘        │
│                                 │
├─────────────────────────────────┤
│   [トレンド映画]                │
│   ←─ [🎬][🎬][🎬][🎬] ─→      │
├─────────────────────────────────┤
│ [Footer]                        │
└─────────────────────────────────┘
```

#### インタラクション
- CTAボタンクリック → `/tmdb-test` へ遷移
- カテゴリーカードクリック → 各カテゴリーページへ遷移
- トレンド映画カードクリック → 映画詳細ページへ遷移

---

### 2. 映画一覧ページ (`/tmdb-test`, `/movies/*`)

#### 目的
映画をカード形式で一覧表示し、ユーザーが映画を探しやすくする

#### 表示内容
- ページタイトル（例: 「人気映画一覧」）
- フィルター・ソートバー（フェーズ2）
- 映画カードグリッド
  - 各カード:
    - ポスター画像（上部）
    - タイトル（中央・太字）
    - 公開日（📅アイコン付き）
    - 評価（★星表示 + 数値）
- ページネーション（下部）

#### レイアウト（現在実装済み）
```
┌─────────────────────────────────────────┐
│ [Header]                                │
├─────────────────────────────────────────┤
│                                         │
│   人気映画一覧                          │
│                                         │
│   ┌────┐ ┌────┐ ┌────┐ ┌────┐        │
│   │📷  │ │📷  │ │📷  │ │📷  │        │
│   │タイ│ │タイ│ │タイ│ │タイ│        │
│   │トル│ │トル│ │トル│ │トル│        │
│   │📅  │ │📅  │ │📅  │ │📅  │        │
│   │★★★│ │★★★│ │★★★│ │★★★│        │
│   └────┘ └────┘ └────┘ └────┘        │
│                                         │
│   [1] [2] [3] ... [10]  [次へ]         │
│                                         │
├─────────────────────────────────────────┤
│ [Footer]                                │
└─────────────────────────────────────────┘
```

#### レスポンシブ動作
- モバイル: 1列
- タブレット: 2-3列
- デスクトップ: 4-5列

#### インタラクション
- ✅ カードホバー → 浮き上がるアニメーション
- カードクリック → 映画詳細ページへ遷移
- ページネーションクリック → ページ切り替え

---

### 3. 映画詳細ページ (`/movies/[id]`)

#### 目的
選択した映画の詳細情報を表示し、ユーザーが映画について深く知る

#### 表示内容

**ヘッダーセクション**
- 背景画像（バックドロップ画像 + オーバーレイ）
- ポスター画像（左側）
- 基本情報（右側）:
  - タイトル（日本語）
  - 原題（英語）
  - 公開日・上映時間
  - ジャンルタグ
  - 評価（★星表示 + 数値 + 投票数）
  - アクションボタン:
    - ❤️ お気に入り
    - 📤 シェア
    - ✓ 観た

**あらすじセクション**
- 概要テキスト

**キャストセクション**
- 主要キャスト（横スクロール）
  - 写真
  - 俳優名
  - 役名

**スタッフセクション**
- 監督
- 脚本
- プロデューサー

**予告編セクション**
- YouTube埋め込み動画

**関連映画セクション**
- おすすめ映画（横スクロール）

#### レイアウト
```
┌──────────────────────────────────────┐
│ [Header]                             │
├──────────────────────────────────────┤
│ [背景画像 + オーバーレイ]            │
│  ┌──┐                                │
│  │📷│  タイトル                      │
│  │ポ│  Original Title                │
│  │ス│  2024 • 120分 • [ジャンル]     │
│  │タ│  ★★★★☆ 8.5 (1,234票)        │
│  │ー│  [❤️お気に入り] [📤シェア]    │
│  └──┘                                │
├──────────────────────────────────────┤
│ あらすじ                             │
│ ここに映画の概要が入ります...        │
├──────────────────────────────────────┤
│ キャスト                             │
│ ←─ [👤][👤][👤][👤] ─→            │
├──────────────────────────────────────┤
│ 予告編                               │
│ [YouTube Video]                      │
├──────────────────────────────────────┤
│ 関連映画                             │
│ ←─ [🎬][🎬][🎬][🎬] ─→            │
├──────────────────────────────────────┤
│ [Footer]                             │
└──────────────────────────────────────┘
```

#### インタラクション
- お気に入りボタン → ローカルストレージに保存
- シェアボタン → シェアメニュー表示
- 予告編再生 → YouTube埋め込みで再生
- キャスト/関連映画クリック → 該当ページへ遷移

---

### 4. 検索結果ページ (`/search`)

#### 目的
キーワードで映画を検索し、結果を一覧表示

#### 表示内容
- 検索バー（大きめ）
- 検索候補（オートコンプリート）
- 検索結果カードグリッド
- 検索履歴（サイドバー）
- フィルターオプション（ジャンル、評価、年代）

#### レイアウト
```
┌──────────────────────────────────────┐
│ [Header]                             │
├──────────────────────────────────────┤
│                                      │
│   [🔍 検索バー____________]          │
│                                      │
├──────┬───────────────────────────────┤
│履歴  │ 検索結果: "アクション" (42件) │
│      │                               │
│- 映画A│  ┌────┐ ┌────┐ ┌────┐       │
│- 映画B│  │📷  │ │📷  │ │📷  │       │
│- 映画C│  └────┘ └────┘ └────┘       │
│      │                               │
│フィル│  [1] [2] [3] [次へ]           │
│ター  │                               │
│☐ SF  │                               │
│☐ 2024│                               │
└──────┴───────────────────────────────┘
```

#### インタラクション
- 検索バー入力 → リアルタイム検索
- 検索候補クリック → 検索実行
- フィルター選択 → 結果絞り込み
- 検索履歴クリック → 再検索

---

### 5. ログインページ (`/login`)

#### 目的
ユーザー認証を行い、パーソナライズ機能を利用可能にする（フェーズ2以降）

#### 表示内容
- ページタイトル「ログイン」
- メールアドレス入力欄
- パスワード入力欄
- 「ログイン」ボタン
- 「新規登録はこちら」リンク
- ソーシャルログインボタン
  - Googleでログイン
  - GitHubでログイン

#### レイアウト
```
┌──────────────────────────────────────┐
│ [Header]                             │
├──────────────────────────────────────┤
│                                      │
│        🎬 Kadai Movie App            │
│                                      │
│   ┌──────────────────────────┐      │
│   │ メールアドレス           │      │
│   │ [________________]       │      │
│   │                          │      │
│   │ パスワード               │      │
│   │ [________________]       │      │
│   │                          │      │
│   │    [ログイン]            │      │
│   │                          │      │
│   │ ─── または ───           │      │
│   │                          │      │
│   │ [🔷 Googleでログイン]    │      │
│   │ [⚫ GitHubでログイン]    │      │
│   │                          │      │
│   │ 新規登録は[こちら]       │      │
│   └──────────────────────────┘      │
│                                      │
├──────────────────────────────────────┤
│ [Footer]                             │
└──────────────────────────────────────┘
```

#### インタラクション
- ログイン成功 → 前のページまたはトップページへリダイレクト
- ログイン失敗 → エラーメッセージ表示
- 新規登録リンク → `/signup` へ遷移
- ソーシャルログイン → OAuth認証フロー

#### 注意事項
- フェーズ1では実装せず、フェーズ2以降で実装
- 認証なしでも基本機能（閲覧、検索）は利用可能
- お気に入り・レビュー機能にはログインが必要

---

### 6. エラーページ

#### 6-1. 404 Not Found (`/404` または `404.js`)

**目的**: 存在しないページへのアクセス時に表示

**表示内容**:
```
┌──────────────────────────────────────┐
│ [Header]                             │
├──────────────────────────────────────┤
│                                      │
│            🎬 404                    │
│                                      │
│      ページが見つかりません          │
│                                      │
│  お探しのページは存在しないか、      │
│  移動された可能性があります。        │
│                                      │
│     [トップページへ戻る]             │
│     [映画を探す]                     │
│                                      │
├──────────────────────────────────────┤
│ [Footer]                             │
└──────────────────────────────────────┘
```

#### 6-2. 500 Server Error (`/500` または `500.js`)

**目的**: サーバーエラー発生時に表示

**表示内容**:
```
┌──────────────────────────────────────┐
│ [Header]                             │
├──────────────────────────────────────┤
│                                      │
│            ⚠️ 500                    │
│                                      │
│      サーバーエラーが発生しました    │
│                                      │
│  申し訳ございません。                │
│  一時的な問題が発生しています。      │
│  しばらくしてから再度お試しください。│
│                                      │
│     [再読み込み]                     │
│     [トップページへ戻る]             │
│                                      │
├──────────────────────────────────────┤
│ [Footer]                             │
└──────────────────────────────────────┘
```

#### 6-3. API通信エラー（コンポーネント内表示）

**目的**: TMDB APIとの通信エラー時に表示

**表示内容**:
```
┌──────────────────────────────────────┐
│                                      │
│       ⚠️ 通信エラー                  │
│                                      │
│  映画情報の取得に失敗しました。      │
│  インターネット接続を確認して、      │
│  再度お試しください。                │
│                                      │
│  エラー詳細: [エラーメッセージ]      │
│                                      │
│     [再読み込み]                     │
│                                      │
└──────────────────────────────────────┘
```

#### エラーハンドリング戦略

**優先度別対応**:

1. **必須（フェーズ1）**
   - 404ページ
   - API通信エラー表示
   - 画像読み込みエラー（代替画像表示）

2. **推奨（フェーズ2）**
   - 500ページ
   - ネットワークエラー検知
   - エラーログ送信（Sentry等）

3. **拡張（フェーズ3）**
   - ユーザーフレンドリーなエラーメッセージ
   - エラー復旧の自動リトライ
   - オフライン対応

---

### 7. 共通コンポーネント

#### ヘッダー
```
┌──────────────────────────────────────┐
│ [🎬 Kadai]  [🔍______] [人気▼] [❤️] │
└──────────────────────────────────────┘
```

**要素**:
- ロゴ（ホームリンク）
- 検索バー
- カテゴリードロップダウン
- お気に入りアイコン（件数バッジ付き）

#### フッター
```
┌──────────────────────────────────────┐
│ Powered by TMDB [logo]               │
│ © 2025 Kadai Movie App               │
│ [利用規約] [プライバシー] [お問合せ] │
└──────────────────────────────────────┘
```

#### 映画カードコンポーネント（実装済み）
```
┌──────────┐
│          │
│  [画像]  │
│          │
├──────────┤
│タイトル  │
│📅 2024   │
│★★★★☆   │
└──────────┘
```

#### ローディング（スケルトンスクリーン）
```
┌──────────┐ ┌──────────┐ ┌──────────┐
│▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│
│▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│
│▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│ │▒▒▒▒▒▒▒▒▒▒│
└──────────┘ └──────────┘ └──────────┘
```

#### エラー表示
```
┌──────────────────────────────────────┐
│                                      │
│          ⚠️ エラーが発生しました      │
│                                      │
│   映画情報の取得に失敗しました。     │
│   しばらくしてから再度お試しください。│
│                                      │
│          [再読み込み]                │
│                                      │
└──────────────────────────────────────┘
```

---

## 技術スタック

### フロントエンド

#### 現在使用中
- **フレームワーク**: Next.js 14.2.0 (App Router)
- **UIライブラリ**: React 18.3.1
- **言語**: JavaScript
- **スタイリング**: CSS（インラインスタイル）
- **画像最適化**: Next.js Image

#### 今後導入予定
- **言語**: TypeScript（型安全性向上）
- **スタイリング**: Tailwind CSS（開発効率化）
- **状態管理**: Zustand または React Context API
- **フォーム管理**: React Hook Form
- **アイコン**: React Icons
- **アニメーション**: Framer Motion

### バックエンド

#### 現在使用中
- **API**: TMDB API v3
- **環境変数管理**: dotenv (`.env.local`)

#### 今後導入予定
- **認証**: Firebase Authentication または Supabase Auth
- **データベース**: Supabase (PostgreSQL) または Firebase Firestore
- **ストレージ**: Supabase Storage（プロフィール画像等）

### インフラ・デプロイ

#### 現在
- **ホスティング**: ローカル開発環境

#### 今後
- **ホスティング**: Vercel
- **CI/CD**: GitHub Actions
- **ドメイン**: 独自ドメイン取得
- **SSL**: Vercel自動SSL

### 開発ツール

#### 現在使用中
- **パッケージマネージャー**: npm
- **バージョン管理**: Git

#### 今後導入予定
- **リンター**: ESLint
- **フォーマッター**: Prettier
- **テスト**: Jest, React Testing Library
- **E2Eテスト**: Playwright または Cypress
- **エラー監視**: Sentry
- **アナリティクス**: Vercel Analytics, Google Analytics

### 外部サービス

- **映画情報API**: The Movie Database (TMDB) API
- **動画**: YouTube Data API（予告編）
- **画像CDN**: TMDB Image CDN

---

## 開発ロードマップ

### Week 1-2: MVP完成 【現在】

#### 完了
- [x] プロジェクト初期セットアップ
- [x] TMDB API連携
- [x] 人気映画一覧ページ
- [x] 映画カードコンポーネント
- [x] レスポンシブデザイン

#### 進行中
- [ ] 要件定義書作成 ✅
- [ ] 映画詳細ページ
- [ ] カテゴリー別表示
- [ ] 基本ナビゲーション

---

### Week 3-4: コア機能実装

- [ ] 検索機能
- [ ] ページネーション
- [ ] お気に入り機能（ローカル）
- [ ] ローディング・エラー表示
- [ ] ホームページ作成
- [ ] フッター作成

**マイルストーン**: 基本機能が揃い、ユーザーが映画を探して保存できる

---

### Week 5-6: UX向上

- [ ] フィルター・ソート機能
- [ ] ジャンル別表示
- [ ] シェア機能
- [ ] ダークモード
- [ ] アニメーション追加
- [ ] パフォーマンス最適化

**マイルストーン**: ユーザー体験が向上し、使いやすいアプリに

---

### Week 7-8: デプロイ・公開準備

- [ ] TypeScript移行
- [ ] Tailwind CSS導入
- [ ] SEO対策（メタタグ、OGP）
- [ ] エラー監視（Sentry）導入
- [ ] Vercelデプロイ
- [ ] 独自ドメイン設定
- [ ] プライバシーポリシー・利用規約作成

**マイルストーン**: 一般公開可能な状態に

---

### Month 3: ユーザー認証・コミュニティ

- [ ] Firebase/Supabase導入
- [ ] ユーザー認証実装
- [ ] お気に入りのクラウド同期
- [ ] 視聴履歴機能
- [ ] マイ評価機能
- [ ] プロフィールページ

**マイルストーン**: ユーザーがアカウントを持ち、データを保存できる

---

### Month 4+: 高度な機能

- [ ] レビュー・コメント機能
- [ ] レコメンド機能
- [ ] コレクション機能
- [ ] 通知機能
- [ ] 統計・分析機能
- [ ] 動画配信サービス連携

**マイルストーン**: コミュニティ機能が充実し、リピート率向上

---

## UI構成図

### Figmaでの設計推奨

本要件定義書に基づき、以下のページのワイヤーフレーム・モックアップを作成することを推奨します：

1. **ホームページ**
   - ヒーローセクション
   - カテゴリーカード
   - トレンド映画セクション

2. **映画一覧ページ**
   - グリッドレイアウト
   - 映画カードデザイン
   - ページネーション

3. **映画詳細ページ**
   - ヘッダーセクション（背景画像+ポスター）
   - 情報セクション
   - キャスト・スタッフ表示
   - 予告編埋め込み

4. **検索ページ**
   - 検索バー
   - フィルターUI
   - 検索結果表示

5. **お気に入りページ**
   - お気に入り一覧
   - 空状態デザイン

6. **共通コンポーネント**
   - ヘッダー
   - フッター
   - 映画カード
   - ローディング
   - エラー表示

### デザインシステム推奨

#### カラーパレット
- **プライマリ**: `#0070f3` (青)
- **セカンダリ**: `#fbbf24` (黄・星評価)
- **背景**: `#fafafa` (ライト), `#1a1a1a` (ダーク)
- **テキスト**: `#333333` (ライト), `#e5e5e5` (ダーク)
- **グレー**: `#6b7280`, `#9ca3af`, `#d1d5db`
- **エラー**: `#ef4444`
- **成功**: `#10b981`

#### タイポグラフィ
- **フォント**: システムフォント（`system-ui, sans-serif`）
- **見出し**: 太字（700）、24px-32px
- **本文**: 通常（400）、16px
- **小文字**: 14px
- **行間**: 1.5

#### スペーシング
- **余白**: 8px, 16px, 24px, 32px, 48px
- **カード間隔**: 24px-32px
- **セクション間隔**: 48px-64px

---

## 付録

### TMDB API 主要エンドポイント

#### 映画リスト取得
- `GET /movie/popular` - 人気映画
- `GET /movie/now_playing` - 現在上映中
- `GET /movie/upcoming` - 公開予定
- `GET /movie/top_rated` - 高評価

#### 映画詳細
- `GET /movie/{movie_id}` - 映画詳細
- `GET /movie/{movie_id}/credits` - キャスト・スタッフ
- `GET /movie/{movie_id}/videos` - 予告編

#### 検索
- `GET /search/movie` - 映画検索

#### その他
- `GET /genre/movie/list` - ジャンル一覧
- `GET /trending/{media_type}/{time_window}` - トレンド

### 画像URL構成
```
https://image.tmdb.org/t/p/{size}{file_path}
```

**サイズオプション**:
- `w92`, `w154`, `w185`, `w342`, `w500`, `w780`, `original`

### 環境変数設定

`.env.local` に以下を設定：

```env
# TMDB API設定
TMDB_BASE_URL=https://api.themoviedb.org/3
TMDB_API_KEY=your_api_key_here

# 本番環境のみ
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
NEXT_PUBLIC_SENTRY_DSN=https://xxx@sentry.io/xxx
```

---

## 改訂履歴

| バージョン | 日付 | 変更内容 | 担当者 |
|-----------|------|----------|--------|
| 1.0 | 2025-10-15 | 初版作成 | - |

---

## 承認

| 役割 | 氏名 | 承認日 | 署名 |
|-----|------|--------|------|
| プロジェクトマネージャー | | | |
| 開発リード | | | |
| デザイナー | | | |

---

**以上**

本要件定義書に基づき、段階的に開発を進めていきます。

